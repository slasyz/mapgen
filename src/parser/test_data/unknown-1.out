IDENTIFICATION DIVISION.
PROGRAM-ID. FIZZBUZZ.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 FIZZ-NUMBER         PIC 9(2) VALUE 3.
01 BUZZ-NUMBER         PIC 9(2) VALUE 5.
01 MAX-COUNT           PIC 9(3) VALUE 100.
01 FIZZ-WORD           PIC X(4) VALUE "Fizz".
01 BUZZ-WORD           PIC X(4) VALUE "Buzz".
01 FIZZBUZZ-WORD       PIC X(8) VALUE SPACES.

01 COUNTER             PIC 9(3) VALUE 1.
01 FIZZ-REMAINDER      PIC 9(2) VALUE 0.
01 BUZZ-REMAINDER      PIC 9(2) VALUE 0.
01 IS-FIZZ             PIC X VALUE 'N'.
01 IS-BUZZ             PIC X VALUE 'N'.

PROCEDURE DIVISION.
MAIN-LOGIC.
    PERFORM FIZZBUZZ-LOOP
        VARYING COUNTER FROM 1 BY 1
        UNTIL COUNTER > MAX-COUNT.
    STOP RUN.

FIZZBUZZ-LOOP.
    DIVIDE COUNTER BY FIZZ-NUMBER
        GIVING COUNTER REMAINDER FIZZ-REMAINDER.
    DIVIDE COUNTER BY BUZZ-NUMBER
        GIVING COUNTER REMAINDER BUZZ-REMAINDER.
    
    IF FIZZ-REMAINDER = 0
        MOVE 'Y' TO IS-FIZZ
    ELSE
        MOVE 'N' TO IS-FIZZ
    END-IF.
    
    IF BUZZ-REMAINDER = 0
        MOVE 'Y' TO IS-BUZZ
    ELSE
        MOVE 'N' TO IS-BUZZ
    END-IF.
    
    IF IS-FIZZ = 'Y' AND IS-BUZZ = 'Y'
        STRING FIZZ-WORD BUZZ-WORD INTO FIZZBUZZ-WORD
        DISPLAY FIZZBUZZ-WORD
    ELSE IF IS-FIZZ = 'Y'
        DISPLAY FIZZ-WORD
    ELSE IF IS-BUZZ = 'Y'
        DISPLAY BUZZ-WORD
    ELSE
        DISPLAY COUNTER
    END-IF.
